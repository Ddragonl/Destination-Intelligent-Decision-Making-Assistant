<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç›®çš„åœ°è‡ªä¸»å†³ç­–æ™ºèƒ½ä½“</title>
    <!-- é«˜å¾·åœ°å›¾JavaScript API -->
    <!-- æ³¨æ„ï¼šéœ€è¦æ›¿æ¢YOUR_AMAP_WEB_KEYä¸ºä½ çš„é«˜å¾·åœ°å›¾Web API Key -->
    <!-- è·å–æ–¹å¼ï¼šhttps://lbs.amap.com/api/javascript-api/guide/abc/prepare -->
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=2.0&key=YOUR_AMAP_WEB_KEY"></script>
    <script type="text/javascript" src="https://webapi.amap.com/ui/1.1/main.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 0;
            min-height: 600px;
        }

        .sidebar {
            background: #f8f9fa;
            padding: 30px;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
            font-size: 14px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .map-container {
            position: relative;
            height: 100%;
            min-height: 600px;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .result-panel {
            margin-top: 30px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .result-panel.show {
            display: block;
        }

        .result-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .result-header h2 {
            color: #333;
            font-size: 20px;
            margin-left: 10px;
        }

        .destination-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .destination-info h3 {
            color: #667eea;
            font-size: 18px;
            margin-bottom: 10px;
        }

        .destination-info p {
            color: #666;
            margin: 5px 0;
            font-size: 14px;
        }

        .route-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .route-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .route-item label {
            display: block;
            color: #999;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .route-item .value {
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .route-details {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .route-details h4 {
            color: #333;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .route-step {
            padding: 10px;
            margin: 8px 0;
            background: white;
            border-radius: 6px;
            border-left: 3px solid #667eea;
            font-size: 14px;
            color: #666;
        }

        .alternatives {
            margin-top: 20px;
        }

        .alternatives h4 {
            color: #333;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .alternative-item {
            padding: 12px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid #999;
            font-size: 14px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
            display: none;
        }

        .loading.show {
            display: block;
        }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 1fr;
            }

            .sidebar {
                max-height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—ºï¸ ç›®çš„åœ°è‡ªä¸»å†³ç­–æ™ºèƒ½ä½“</h1>
            <p>æ™ºèƒ½æ¨èæœ€ä¼˜ç›®çš„åœ°å’Œäº¤é€šæ–¹æ¡ˆ</p>
        </div>

        <div class="content">
            <div class="sidebar">
                <form id="queryForm">
                    <div class="form-group">
                        <label for="userLocation">ğŸ“ æˆ‘çš„ä½ç½®</label>
                        <input type="text" id="userLocation" name="userLocation" 
                               placeholder="ä¾‹å¦‚ï¼šæµ™æ±Ÿå¤§å­¦ç´«é‡‘æ¸¯æ ¡åŒº" required>
                    </div>

                    <div class="form-group">
                        <label for="storeName">ğŸª è¿é”åº—åç§°</label>
                        <input type="text" id="storeName" name="storeName" 
                               placeholder="ä¾‹å¦‚ï¼šè”æƒ³ç”µè„‘ä¸“å–åº—" required>
                    </div>

                    <div class="form-group">
                        <label for="city">ğŸ™ï¸ æ‰€åœ¨åŸå¸‚</label>
                        <input type="text" id="city" name="city" 
                               placeholder="ä¾‹å¦‚ï¼šæ­å·" value="æ­å·" required>
                    </div>

                    <div class="form-group">
                        <label for="trafficMode">ğŸšŒ äº¤é€šæ–¹å¼</label>
                        <select id="trafficMode" name="trafficMode">
                            <option value="">è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜</option>
                            <option value="transit">å…¬å…±äº¤é€šï¼ˆå…¬äº¤/åœ°é“ï¼‰</option>
                            <option value="driving">é©¾è½¦</option>
                            <option value="walking">æ­¥è¡Œ</option>
                            <option value="riding">éª‘è¡Œ</option>
                        </select>
                    </div>

                    <button type="submit" class="btn" id="submitBtn">
                        ğŸ” å¼€å§‹æŸ¥è¯¢
                    </button>
                </form>

                <div class="loading" id="loading">
                    <div class="loading-spinner"></div>
                    <p>æ­£åœ¨æŸ¥è¯¢ä¸­ï¼Œè¯·ç¨å€™...</p>
                </div>

                <div class="error-message" id="errorMessage"></div>

                <div class="result-panel" id="resultPanel">
                    <div class="result-header">
                        <span style="font-size: 24px;">âœ…</span>
                        <h2>æ¨èç»“æœ</h2>
                    </div>

                    <div class="destination-info" id="destinationInfo"></div>

                    <div class="route-info" id="routeInfo"></div>

                    <div class="route-details" id="routeDetails"></div>

                    <div class="alternatives" id="alternatives"></div>
                </div>
            </div>

            <div class="map-container">
                <div id="map"></div>
            </div>
        </div>
    </div>

    <script>
        // æ³¨æ„ï¼šéœ€è¦æ›¿æ¢ä¸ºä½ çš„é«˜å¾·åœ°å›¾Web API Key
        // å¦‚æœå·²ç»åœ¨HTMLä¸­è®¾ç½®äº†ï¼Œè¿™é‡Œå¯ä»¥ç•™ç©º
        const AMAP_WEB_KEY = 'YOUR_AMAP_WEB_KEY';

        let map;
        let markers = [];
        let routePolyline = null;

        // åˆå§‹åŒ–åœ°å›¾
        function initMap() {
            map = new AMap.Map('map', {
                zoom: 13,
                center: [120.153576, 30.287459], // æ­å·å¸‚ä¸­å¿ƒ
                viewMode: '3D'
            });

            // æ·»åŠ åœ°å›¾æ§ä»¶
            map.addControl(new AMap.Scale());
            map.addControl(new AMap.ToolBar());
        }

        // æ¸…é™¤åœ°å›¾ä¸Šçš„æ ‡è®°å’Œè·¯çº¿
        function clearMap() {
            markers.forEach(marker => map.remove(marker));
            markers = [];
            if (routePolyline) {
                map.remove(routePolyline);
                routePolyline = null;
            }
        }

        // åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºè·¯çº¿
        function displayRoute(routeData) {
            clearMap();

            const origin = routeData.recommendation.destination.coordinates;
            const destination = routeData.recommendation.destination.coordinates;
            
            // è·å–èµ·ç‚¹åæ ‡ï¼ˆéœ€è¦ä»APIè¿”å›çš„æ•°æ®ä¸­è·å–ï¼‰
            // è¿™é‡Œå‡è®¾APIè¿”å›äº†èµ·ç‚¹çš„åæ ‡ä¿¡æ¯
            // å¦‚æœæ²¡æœ‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåœ°ç†ç¼–ç èµ·ç‚¹
            
            // æ˜¾ç¤ºç›®çš„åœ°æ ‡è®°
            const destMarker = new AMap.Marker({
                position: [destination.longitude, destination.latitude],
                title: routeData.recommendation.destination.name,
                icon: new AMap.Icon({
                    size: new AMap.Size(40, 50),
                    image: 'https://webapi.amap.com/theme/v1.3/markers/n/mid_r.png',
                    imageOffset: new AMap.Pixel(-9, -3),
                    imageSize: new AMap.Size(18, 25)
                })
            });
            markers.push(destMarker);
            map.add(destMarker);

            // å¦‚æœæœ‰è·¯çº¿è¯¦æƒ…ï¼Œç»˜åˆ¶è·¯çº¿
            if (routeData.recommendation.route.details && routeData.recommendation.route.details.length > 0) {
                // ä»è·¯çº¿è¯¦æƒ…ä¸­æå–åæ ‡ç‚¹
                const path = extractPathFromDetails(routeData.recommendation.route.details);
                if (path.length > 0) {
                    routePolyline = new AMap.Polyline({
                        path: path,
                        isOutline: true,
                        outlineColor: '#ffeeff',
                        borderWeight: 3,
                        strokeColor: '#3366FF',
                        strokeOpacity: 1,
                        strokeWeight: 6,
                        strokeStyle: 'solid',
                        lineJoin: 'round',
                        lineCap: 'round',
                        zIndex: 50
                    });
                    map.add(routePolyline);
                    map.setFitView([routePolyline]);
                }
            } else {
                // å¦‚æœæ²¡æœ‰è¯¦ç»†è·¯çº¿ï¼Œè‡³å°‘æ˜¾ç¤ºèµ·ç‚¹å’Œç»ˆç‚¹
                map.setCenter([destination.longitude, destination.latitude]);
                map.setZoom(15);
            }
        }

        // ä»è·¯çº¿è¯¦æƒ…ä¸­æå–è·¯å¾„ç‚¹ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰
        function extractPathFromDetails(details) {
            // è¿™é‡Œéœ€è¦æ ¹æ®å®é™…çš„è·¯çº¿æ•°æ®æ ¼å¼æ¥æå–
            // ç”±äºé«˜å¾·åœ°å›¾APIè¿”å›çš„è·¯çº¿æ•°æ®æ ¼å¼å¤æ‚ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬
            // å®é™…ä½¿ç”¨æ—¶ï¼Œå¯èƒ½éœ€è¦è°ƒç”¨é«˜å¾·åœ°å›¾çš„è·¯å¾„è§„åˆ’APIæ¥è·å–å®Œæ•´çš„è·¯å¾„åæ ‡
            return [];
        }

        // åœ°ç†ç¼–ç èµ·ç‚¹
        async function geocodeAddress(address) {
            return new Promise((resolve, reject) => {
                const geocoder = new AMap.Geocoder();
                geocoder.getLocation(address, (status, result) => {
                    if (status === 'complete' && result.geocodes.length > 0) {
                        const location = result.geocodes[0].location;
                        resolve([location.lng, location.lat]);
                    } else {
                        reject(new Error('åœ°ç†ç¼–ç å¤±è´¥'));
                    }
                });
            });
        }

        // æŸ¥è¯¢è·¯çº¿å¹¶åœ¨åœ°å›¾ä¸Šæ˜¾ç¤º
        async function queryAndDisplayRoute() {
            const userLocation = document.getElementById('userLocation').value;
            const storeName = document.getElementById('storeName').value;
            const city = document.getElementById('city').value;
            const trafficMode = document.getElementById('trafficMode').value;

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('loading').classList.add('show');
            document.getElementById('resultPanel').classList.remove('show');
            document.getElementById('errorMessage').classList.remove('show');
            document.getElementById('submitBtn').disabled = true;

            try {
                // è°ƒç”¨åç«¯API
                const response = await fetch('/api/query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        user_location: userLocation,
                        store_name: storeName,
                        city: city,
                        preferred_mode: trafficMode || null
                    })
                });

                const data = await response.json();

                if (data.success) {
                    // æ˜¾ç¤ºç»“æœ
                    displayResult(data);
                    
                    // åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºè·¯çº¿
                    await displayRouteOnMap(data, userLocation);
                } else {
                    showError(data.error || 'æŸ¥è¯¢å¤±è´¥');
                }
            } catch (error) {
                showError('ç½‘ç»œé”™è¯¯ï¼š' + error.message);
            } finally {
                document.getElementById('loading').classList.remove('show');
                document.getElementById('submitBtn').disabled = false;
            }
        }

        // åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºå®Œæ•´è·¯çº¿
        async function displayRouteOnMap(routeData, userLocationStr) {
            clearMap();

            try {
                // åœ°ç†ç¼–ç èµ·ç‚¹
                const originCoords = await geocodeAddress(userLocationStr);
                
                // ç›®çš„åœ°åæ ‡
                const destCoords = [
                    routeData.recommendation.destination.coordinates.longitude,
                    routeData.recommendation.destination.coordinates.latitude
                ];

                // æ·»åŠ èµ·ç‚¹æ ‡è®°
                const originMarker = new AMap.Marker({
                    position: originCoords,
                    title: 'èµ·ç‚¹',
                    icon: new AMap.Icon({
                        size: new AMap.Size(40, 50),
                        image: 'https://webapi.amap.com/theme/v1.3/markers/n/mid_b.png',
                        imageOffset: new AMap.Pixel(-9, -3),
                        imageSize: new AMap.Size(18, 25)
                    })
                });
                markers.push(originMarker);
                map.add(originMarker);

                // æ·»åŠ ç»ˆç‚¹æ ‡è®°
                const destMarker = new AMap.Marker({
                    position: destCoords,
                    title: routeData.recommendation.destination.name,
                    icon: new AMap.Icon({
                        size: new AMap.Size(40, 50),
                        image: 'https://webapi.amap.com/theme/v1.3/markers/n/mid_r.png',
                        imageOffset: new AMap.Pixel(-9, -3),
                        imageSize: new AMap.Size(18, 25)
                    })
                });
                markers.push(destMarker);
                map.add(destMarker);

                // æ ¹æ®äº¤é€šæ–¹å¼ç»˜åˆ¶è·¯çº¿
                const mode = routeData.recommendation.route.traffic_mode;
                await drawRoute(originCoords, destCoords, mode);

                // è°ƒæ•´åœ°å›¾è§†é‡
                map.setFitView(markers);
            } catch (error) {
                console.error('åœ°å›¾æ˜¾ç¤ºé”™è¯¯:', error);
                // å³ä½¿è·¯çº¿ç»˜åˆ¶å¤±è´¥ï¼Œè‡³å°‘æ˜¾ç¤ºç›®çš„åœ°
                const destCoords = [
                    routeData.recommendation.destination.coordinates.longitude,
                    routeData.recommendation.destination.coordinates.latitude
                ];
                map.setCenter(destCoords);
                map.setZoom(15);
            }
        }

        // ç»˜åˆ¶è·¯çº¿
        async function drawRoute(origin, destination, mode) {
            return new Promise((resolve, reject) => {
                let routeService;
                
                if (mode === 'transit') {
                    // å…¬äº¤è·¯çº¿è§„åˆ’
                    routeService = new AMap.Transfer({
                        map: map,
                        city: document.getElementById('city').value,
                        panel: null,
                        hideMarkers: false
                    });
                    routeService.search([
                        new AMap.LngLat(origin[0], origin[1]),
                        new AMap.LngLat(destination[0], destination[1])
                    ], (status, result) => {
                        if (status === 'complete') {
                            resolve();
                        } else {
                            console.warn('å…¬äº¤è·¯çº¿è§„åˆ’å¤±è´¥ï¼Œä½¿ç”¨ç›´çº¿è¿æ¥');
                            drawStraightLine(origin, destination);
                            resolve();
                        }
                    });
                } else if (mode === 'driving') {
                    // é©¾è½¦è·¯çº¿è§„åˆ’
                    routeService = new AMap.Driving({
                        map: map,
                        panel: null,
                        hideMarkers: false
                    });
                    routeService.search(new AMap.LngLat(origin[0], origin[1]), 
                                  new AMap.LngLat(destination[0], destination[1]), 
                                  (status, result) => {
                        if (status === 'complete') {
                            resolve();
                        } else {
                            console.warn('é©¾è½¦è·¯çº¿è§„åˆ’å¤±è´¥ï¼Œä½¿ç”¨ç›´çº¿è¿æ¥');
                            drawStraightLine(origin, destination);
                            resolve();
                        }
                    });
                } else if (mode === 'walking') {
                    // æ­¥è¡Œè·¯çº¿è§„åˆ’
                    routeService = new AMap.Walking({
                        map: map,
                        panel: null,
                        hideMarkers: false
                    });
                    routeService.search(new AMap.LngLat(origin[0], origin[1]), 
                                  new AMap.LngLat(destination[0], destination[1]), 
                                  (status, result) => {
                        if (status === 'complete') {
                            resolve();
                        } else {
                            console.warn('æ­¥è¡Œè·¯çº¿è§„åˆ’å¤±è´¥ï¼Œä½¿ç”¨ç›´çº¿è¿æ¥');
                            drawStraightLine(origin, destination);
                            resolve();
                        }
                    });
                } else {
                    // éª‘è¡Œæˆ–å…¶ä»–ï¼Œä½¿ç”¨ç›´çº¿è¿æ¥
                    drawStraightLine(origin, destination);
                    resolve();
                }
            });
        }

        // ç»˜åˆ¶ç›´çº¿è¿æ¥ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
        function drawStraightLine(origin, destination) {
            if (routePolyline) {
                map.remove(routePolyline);
            }
            routePolyline = new AMap.Polyline({
                path: [
                    new AMap.LngLat(origin[0], origin[1]),
                    new AMap.LngLat(destination[0], destination[1])
                ],
                strokeColor: '#3366FF',
                strokeWeight: 4,
                strokeOpacity: 0.8,
                strokeStyle: 'dashed'
            });
            map.add(routePolyline);
        }

        // æ˜¾ç¤ºæŸ¥è¯¢ç»“æœ
        function displayResult(data) {
            const rec = data.recommendation;
            const route = rec.route;

            // æ˜¾ç¤ºç›®çš„åœ°ä¿¡æ¯
            document.getElementById('destinationInfo').innerHTML = `
                <h3>${rec.destination.name}</h3>
                <p>ğŸ“ ${rec.destination.address}</p>
            `;

            // æ˜¾ç¤ºè·¯çº¿ä¿¡æ¯
            document.getElementById('routeInfo').innerHTML = `
                <div class="route-item">
                    <label>äº¤é€šæ–¹å¼</label>
                    <div class="value">${route.traffic_mode_cn}</div>
                </div>
                <div class="route-item">
                    <label>é¢„è®¡æ—¶é—´</label>
                    <div class="value">${route.duration_formatted}</div>
                </div>
                <div class="route-item">
                    <label>è·ç¦»</label>
                    <div class="value">${route.distance_formatted}</div>
                </div>
                ${route.cost ? `
                <div class="route-item">
                    <label>è´¹ç”¨</label>
                    <div class="value">${route.cost}å…ƒ</div>
                </div>
                ` : ''}
            `;

            // æ˜¾ç¤ºè¯¦ç»†è·¯çº¿
            if (route.details && route.details.length > 0) {
                let detailsHtml = '<h4>ğŸ“‹ è¯¦ç»†è·¯çº¿</h4>';
                route.details.forEach((detail, index) => {
                    if (detail.type === 'walking') {
                        detailsHtml += `<div class="route-step">${index + 1}. ğŸš¶ ${detail.instruction}</div>`;
                    } else if (detail.type === 'bus') {
                        detailsHtml += `<div class="route-step">${index + 1}. ğŸšŒ ${detail.instruction}<br>
                            <small style="color: #999;">ä» ${detail.departure} åˆ° ${detail.arrival}</small></div>`;
                    } else if (detail.type === 'subway') {
                        detailsHtml += `<div class="route-step">${index + 1}. ğŸš‡ ${detail.instruction}<br>
                            <small style="color: #999;">ä» ${detail.departure} åˆ° ${detail.arrival}</small></div>`;
                    } else {
                        detailsHtml += `<div class="route-step">${index + 1}. ${detail.instruction || ''}</div>`;
                    }
                });
                document.getElementById('routeDetails').innerHTML = detailsHtml;
            } else if (route.summary) {
                document.getElementById('routeDetails').innerHTML = `
                    <h4>ğŸ“‹ è·¯çº¿æ‘˜è¦</h4>
                    <div class="route-step">${route.summary}</div>
                `;
            } else {
                document.getElementById('routeDetails').innerHTML = '';
            }

            // æ˜¾ç¤ºå¤‡é€‰æ–¹æ¡ˆ
            if (data.alternatives && data.alternatives.length > 0) {
                let altHtml = '<h4>ğŸ”„ å¤‡é€‰æ–¹æ¡ˆ</h4>';
                data.alternatives.forEach((alt, index) => {
                    altHtml += `
                        <div class="alternative-item">
                            <strong>${alt.destination}</strong><br>
                            <small>${alt.traffic_mode} Â· ${alt.duration} Â· ${alt.distance}</small>
                        </div>
                    `;
                });
                document.getElementById('alternatives').innerHTML = altHtml;
            } else {
                document.getElementById('alternatives').innerHTML = '';
            }

            // æ˜¾ç¤ºç»“æœé¢æ¿
            document.getElementById('resultPanel').classList.add('show');
        }

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = 'âŒ ' + message;
            errorEl.classList.add('show');
        }

        // è¡¨å•æäº¤äº‹ä»¶
        document.getElementById('queryForm').addEventListener('submit', (e) => {
            e.preventDefault();
            queryAndDisplayRoute();
        });

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åœ°å›¾
        window.onload = () => {
            initMap();
        };
    </script>
</body>
</html>

